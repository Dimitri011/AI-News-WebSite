{% load static %}
<!doctype html>
<html lang="ro">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>{{ settings.site_name|default:"Telegrame" }}</title>
    <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet">
    {% block head_css %}{% endblock %}
</head>
<body>
    <header class="header">
        <a href="{% url 'home' %}" class="logo-wrap">
            {% if settings.logo %}
            <img src="{{ settings.logo.url }}" alt="Logo" class="logo" />
            {% else %}
            <img src="{% static 'core/img/Telegrame_Logo.png' %}" alt="Logo" class="logo" />
            {% endif %}
        </a>

        <div class="right-header">
            <span class="date-line">{% now "d.m.Y" %}</span>

            {% if request.user.is_authenticated %}
            <form id="logout-form" method="post" action="{% url 'logout' %}" style="display:none;">
                {% csrf_token %}
            </form>
            <a href="#" class="login-btn" title="Logout"
               onclick="document.getElementById('logout-form').submit();return false;">
                <i class="ri-logout-box-r-line"></i>
            </a>
            {% else %}
            <a href="{% url 'login' %}" class="login-btn" title="Autentificare">
                <i class="ri-user-3-line"></i>
            </a>
            {% endif %}
        </div>

    </header>

    <div class="urgent-text" id="urgent-bar">
        <strong>URGENT:</strong>
        {% if settings.urgent_link %}
        <a href="{{ settings.urgent_link }}" style="color:inherit;text-decoration:none;">
            <span id="urgent-text">{{ settings.urgent_text|default:"—" }}</span>
        </a>
        {% else %}
        <span id="urgent-text">{{ settings.urgent_text|default:"—" }}</span>
        {% endif %}

        {% if request.user.is_authenticated %}
        <a href="#" id="urgent-edit" style="margin-left:8px;text-decoration:none;" title="Editeaza"><i class="ri-edit-2-line"></i></a>
        <form id="urgent-form" method="post" action="{% url 'urgent_update' %}" style="display:none;margin-top:6px;">
            {% csrf_token %}
            <input type="text" name="urgent_text" value="{{ settings.urgent_text }}" placeholder="Text URGENT">
            <input type="text" name="urgent_link" value="{{ settings.urgent_link }}" placeholder="Link (optional)">
            <button type="submit">Salveaza</button>
            <button type="button" id="urgent-cancel">Anuleaza</button>
        </form>
        {% endif %}
    </div>

    {% if messages %}
    <ul style="max-width:980px;margin:10px auto;list-style:none;padding:0;">
        {% for m in messages %}
        <li style="padding:8px 12px;border:1px solid #333;border-radius:8px;margin-bottom:6px;opacity:.9;">{{ m }}</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% block content %}{% endblock %}

    {% block foot_js %}
    {% if request.user.is_authenticated %}
    <script>
      (function(){
        var e=document.getElementById('urgent-edit');
        if(!e) return;
        var f=document.getElementById('urgent-form');
        var c=document.getElementById('urgent-cancel');
        e.addEventListener('click', function(ev){ev.preventDefault(); f.style.display='block';});
        c.addEventListener('click', function(){f.style.display='none';});
      })();
    </script>
    {% endif %}
    {% endblock %}
</body>
</html>
